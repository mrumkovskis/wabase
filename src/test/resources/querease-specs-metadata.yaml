table: person
columns:
- id
- name                 ! 51
- surname                52


name: person
table: person p
auth insert:  :surname != 'Readonly'
auth update: p.surname != 'Readonly'
auth delete: p.surname  = 'Readonly'
fields:
- id
- name
- surname


table:   sys_user
columns:
- id
- person.id            !
- password


table:   sys_role
columns:
- id
- name                 ! 64
uk:
- name


table:   sys_user_role
columns:
- id
- sys_user.id          !
- sys_role.id          !
idx:
- sys_user_id


name: sys_role_choice
table: sys_role r
fields:
- id
- name
filter:
- name


name: sys_user_role_choice
table: sys_user_role ur
fields:
- id
- sys_role = ^sys_role_choice.name ->


name:   sys_user_with_ro_roles
table:  sys_user u
joins:
- u / person p_
fields:
- id
- p_.name
- roles [!] * sys_user_role_choice


name:     sys_user_with_roles
extends:  sys_user_with_ro_roles
fields:
- roles [+] * sys_user_role_choice
